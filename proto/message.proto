syntax = "proto3";

option go_package = "github.com/khang/mcmanager/internal/gen;gen";

enum MessageType {
  UNKOWN = 0;
  // server message type in range 0x0000 to 0x7FFF
  ERROR = 0x0001;
  CMD_OUTPUT = 0x0101;
  CMD_STATUS = 0x0102;

  // client message type in range 0x8000 to 0xFFFF
  SUBSCRIBE = 0x8001;
  UNSUBSCRIBE = 0x8002;
  CMD_INPUT = 0x8101;
  CMD_RESIZE = 0x8102;
  CMD_CONNECT = 0x8103;
}

message ErrorInfo {
  string code = 1;
  string message = 2;
}

message CmdInput {
  string id = 1;
  bytes data = 2;
}

message CmdOutput {
  string id = 1;
  bytes data = 2;
}

message CmdResize {
  string id = 1;
  uint32 cols = 2;
  uint32 rows = 3;
}

message CmdStatus {
  string id = 1;
  string status = 2;
}

message CmdConnect {
  string id = 1;
}

message Subscribe {
  string topic = 1;
}

message Unsubscribe {
  string topic = 1;
}

message Message {
  MessageType type = 1;
  oneof payload {
    ErrorInfo error = 2;
    Subscribe subscribe = 3;
    Unsubscribe unsubscribe = 4;
    CmdInput cmd_input = 5;
    CmdOutput cmd_output = 6;
    CmdResize cmd_resize = 7;
    CmdStatus cmd_status = 8;
    CmdConnect cmd_connect = 9;
  }
}
